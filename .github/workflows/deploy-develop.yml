name: deploy-develop-android
run-name: Build and deploy develop build for Android
on:
  push:
    branches:
      - "develop"
jobs:
  build-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: develop
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.16.9'
          channel: 'stable'
      - uses: pocket-apps/action-setup-firebase@v2
        with:
          firebase_token: ${{ secrets.FIREBASE_TOKEN }}
      - name: get dependencies
        run: flutter pub get
      - name: configure flutterfire
        run: |
          dart pub global activate flutterfire_cli
          flutterfire configure -y -p unn-mobile-1
      - name: build
        run: flutter build appbundle
      - name: deploy
        env:
          app_id: ${{ secrets.FIREBASE_A_APP_ID }}
        run: firebase appdistribution:distribute build/app/outputs/bundle/release/app-release.aab --app $app_id --release-notes $(git log -1 --pretty=%B)



